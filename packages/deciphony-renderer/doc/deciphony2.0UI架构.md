使用Svg。 采用完全的绝对布局。不使用皮肤包，默认展示色块

看看svg能否实现，父级固定，子元素超出部分仍然可以点击这一功能，如果不能，还是要使用div

svg无法实现子元素超出，这对于实现更炫酷的皮肤不利

使用div

复谱表、单谱表、小节 普通文档流

但是跨小节元素肯定是绝对布局，两个布局不一致

其实细想，五线谱就不应该是绝对布局。 复谱表、单谱表、小节就应该是普通文档流，其实直到小节这一步，都应该沿用deciphony1.0的设计。

但是符号这里确实出现了 蹩脚的地方

考虑div能否实现连音线的形状，好像不能

所以还是要用svg

通过widthRatio计算坐标

这里的坐标点是指svg矩形中间点的坐标，不在代码里通过符号类型设置符号的宽高限制。直接通过固定规格的符号svg大小来设置

跟随符号概念保留，这次跟随符号的谱号符号直接区分开发，不再使用msSymbol:[msSymbol]
这种无限嵌套的形式。因为根本没有嵌套的可能。因为符干和符尾比较特殊，所以不在跟随符号中，单独以音符头属性的形式存在，通过chronaxie自动控制显隐

跟随符号渲染在其依附的主节点上，会被后面的节点覆盖，但是这个无伤大雅，允许存在

符号上不需要绑定跨小节符号信息

跨小节符号绑定符号信息

先将符号渲染成虚拟dom信息，然后通过层级属性先后排序，再统一渲染到svg上

连音线，定义为双音符跟随符号，和跟随符号不同的是，双跟随符号直接在根属性上， 绑定音符id,

volta， 定义为双小节跟随符号，通过两个小节定位。

根属性中不存储连音组信息。而是在第二遍针对符杠渲染时。挨个小节进行符杠生成并重算符干高度和方向。方向少数服从多数。

## 平铺还是嵌套

我想把musicScore数据转换为vDom时，改为平铺的g而不是复谱表套单谱表的。因为dom节点浅，性能更高，更重要的一点是，平铺后我能完美的控制每个符号的层级，因为svg里是靠dom先后顺序控制层级的。但是嵌套层级的好处是，复谱表进行平移操作时，不需要同步计算子元素。你觉得怎么样比较好

结论
更推荐平铺结构，因为：
乐谱对绘制顺序要求高，平铺 + layer 更可控；
性能更好；
平移可以通过外层 transform 或临时包装解决，不必牺牲层级控制。
如果你决定改成平铺，可以在 vDom 里加 layer 字段，按 layer 排序后再渲染，这样就能精确控制每个符号的叠放顺序。

最终决定。使用完全平铺，意思是包括附属符号符干，符尾等都要在根层级。
至于拖拽某一符号，需要同步调整哪些其它符号，需要使用diff算法更新出vDom,然后比对vDom进行差异部分渲染

双小节附属，
双音符附属
单音符附属

音符或小节上不存储任何信息，附属符号完全在根属性上